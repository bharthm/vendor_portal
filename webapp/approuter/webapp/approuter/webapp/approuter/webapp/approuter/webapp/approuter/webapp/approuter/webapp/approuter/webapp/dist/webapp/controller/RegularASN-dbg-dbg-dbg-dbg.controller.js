sap.ui.define(["zmmsubcontract/controller/BaseController","sap/m/MessageBox","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/core/date/UI5Date","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/PDFViewer"],function(e,t,r,n,a,o,i,s,d){"use strict";return e.extend("zmmsubcontract.controller.RegularASN",{_data:{dtValue:o.getInstance(),dtPattern:undefined},onInit:function(){e.prototype.onInit.apply(this);this._localModel=this.getOwnerComponent().getModel("local");debugger;this.oRouter.getRoute("RegASN").attachPatternMatched(this._onObjectMatched,this);this.oRouter=this.getOwnerComponent().getRouter();this._readData();this.oRouter=this.getOwnerComponent().getRouter()},_readData:function(){var e=this.getOwnerComponent().getModel();var r=this.getOwnerComponent().getModel("selectedRecords");if(!r){r=new n([]);this.getOwnerComponent().setModel(r,"selectedRecords")}this.getView().byId("idRegASN").setModel(e);var a=this;sap.ui.core.BusyIndicator.show(0);this.getOwnerComponent().setModel(e,"defaultModel");e.read("/zet_da_listSet",{success:function(e,t){debugger;sap.ui.core.BusyIndicator.hide();var r=new sap.ui.model.json.JSONModel;r.setData(e.results);a.getView().setModel(r,"default")},error:function(e){debugger;console.log(e);t.error(JSON.parse(e.responseText).error.innererror.errordetails[0].message)}})},_onObjectMatched:function(e){this._refreshView()},_refreshView:function(){this._readData()},onSearchVendor:function(e){this._applySearchFilter("Lifnr",e.getParameter("query"))},onSearchWerks:function(e){this._applySearchFilter("Werks",e.getParameter("query"))},_applySearchFilter:function(e,t){var r=[];debugger;if(t&&t.length>0){var n=new i(e,s.Contains,t);r.push(n)}var a=this.byId("idDetail");var o=a.getBinding("items");o.filter(r,"Application")},_selectedData:function(e){var r=this.getOwnerComponent().getModel("selectedRecords");var n=this.getView();var a=n.byId("idRegASN");var o=a.getSelectedItems();var i=[];if(o.length===0){debugger;t.error("Please Enter at least one Record");return}var s=o[0].getBindingContext("default");var d=s.getProperty("Ebeln");var l=s.getProperty("Ebelp");debugger;o.forEach(function(e,r){r=r+1;if(r>4){t.error("You have selected more than 4 items. Please select up to 4 items only.");return}});var u=o.every(function(e){var t=e.getBindingContext("default");if(t){var r=t.getProperty("Ebeln");var n=t.getProperty("Ebelp");return r===d&&n===l}return false});if(!u){t.error("Please select records with the same PO and PO Line Item.");return}o.forEach(function(e){var t=e.getBindingContext("default");if(t){i.push(t.getObject())}else{console.log("No binding context found for item:",e)}});sap.ui.getCore().setModel(r,"selectedItemsModel");r.setData(i);var g=sap.ui.core.UIComponent.getRouterFor(this);g.navTo("subconASNcr");debugger;var c={};c.vendor=r.oData[0].Lifnr;c.plant=r.oData[0].Werks;c.outputmat=r.oData[0].Op_matnr;c.Ebeln=r.oData[0].Ebeln;c.Ebelp=r.oData[0].Ebelp;var f=new sap.ui.model.json.JSONModel;f.setData(c);this.getOwnerComponent().setModel(f,"ASNMODEL")},onCreateASN:function(e){this._selectedData(e).bind(this);this._displayCrtAsnEH()},_displayCrtAsnEH:function(){this.oRouter.navTo("subconASNcr")},onPreviewPDF:function(e){var t=e.getSource();var r=t.getBindingContext("default");var n=r.getObject();var a=this.getView();var o=a.getModel();var i=new d;this.getView().addDependent(i);var s=o.sServiceUrl;var l="/zdapdfSet(Werks='"+n.Werks+"',Lifnr='"+n.Lifnr+"',Exnum='"+n.Exnum+"',Exdat='"+n.Exdat+"')/$value";var u=s+"/zdapdfSet(Werks='"+n.Werks+"',Lifnr='"+n.Lifnr+"',Exnum='"+n.Exnum+"',Exdat='"+n.Exdat+"')/$value";i.setSource(u);i.setTitle("DA PDF");i.open()},onMat:function(e){debugger;var t=e.getParameter("newValue");var r=this.byId("idRegASN");var n=r.getBinding("items");var a=[];if(t&&t.length>0){var o=new i("Op_matnr",s.Contains,t);var d=new i("Ip_Matnr",s.Contains,t);a.push(new i({filters:[o,d],and:false}))}n.filter(a)},onPlant:function(e){debugger;var t=e.getParameter("newValue");var r=this.byId("idRegASN");var n=r.getBinding("items");var a=[];if(t&&t.length>0){var o=new i("Werks",s.Contains,t);a.push(new i({filters:[o],and:false}))}n.filter(a)},onDA:function(e){debugger;var t=e.getParameter("newValue");var r=this.byId("idRegASN");var n=r.getBinding("items");var a=[];if(t&&t.length>0){var o=new i("Exnum",s.Contains,t);a.push(new i({filters:[o],and:false}))}n.filter(a)},onVendor:function(e){debugger;var t=e.getParameter("newValue");var r=this.byId("idRegASN");var n=r.getBinding("items");var a=[];if(t&&t.length>0){var o=new i("Lifnr",s.Contains,t);a.push(new i({filters:[o],and:false}))}n.filter(a)}})});
//# sourceMappingURL=RegularASN-dbg-dbg-dbg-dbg.controller.js.map